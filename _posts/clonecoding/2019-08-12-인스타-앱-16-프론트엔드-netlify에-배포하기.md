```
layout: post
title: "[인스타클론코딩] [App].16 - manstagram 배포하기 "
date: 2019-08-12-21:39:00
author: 한만섭
categories: clonecoding
tags: react instagram netlify
```



[TOC]

## 1. front-end 배포하기 

front-end를 배포할 때 자주 사용하는 [netlify](https://www.netlify.com/)를 사용해보록 하겠습니다.   



### 1-1. netlify 권한 설정

netlify에서 모든 repository에 접근할 수 있도록 허용해줍니다.  

![1565614426553](../../../../assets/image/1565614426553.png)



### 1-2. front-end 프로젝트 선택 

![1565614493123](../../../../assets/image/1565614493123.png)

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- displayAd -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-4877378276818686"
     data-ad-slot="2489269721"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

### 1-3. build 명령어 및 빌드 파일 경로 입력 

![1565614566154](../../../../assets/image/1565614566154.png)

첫번째 칸에는 

```bash
npm run build
```

두번째 칸에는 

```
build/
```

를 작성하고 **Deploy site**를 누르면 아래와 같이 배포를 진행한 후에 **site is live**라는 문구가 나오면 배포에 성공한 것입니다.  

![1565615354673](../../../../assets/image/1565615354673.png)





## 2. server 배포하기 



서버를 배포하기 위해서는 최종적으로는 **heroku**를 사용할 것이지만 우선 로컬 컴퓨터에서 **testing**을 해보고 배포해보도록 하겠습니다.  

### 2-1. @bable/cli 설치 

![1565616351228](../../../../assets/image/1565616351228.png)

저는 기존에 설치가 되어 있었기 때문에 따로 설치하지는 않도록 하겠습니다. 설치를 했다면이제 빌드를 진행할 수 있습니다.  

### 2-2. src 파일 build하기 

`pakage.json`의 `scripts`에 `build`명령어를 추가해줍니다. 지금 사용하는 것은 **Heroku**에 배포하기 전에 테스트를 하는 과정입니다.  

![1565616588931](../../../../assets/image/1565616588931.png)

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- displayAd -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-4877378276818686"
     data-ad-slot="2489269721"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

이 과정 후에 빌드 명령어를 작성했지만 에러가 발생했습니다.  

```bash
npm run build
```

![1565616748735](../../../../assets/image/1565616748735.png)

아마 **babel**이 뭔가 문제가 있는 것 같습니다.  

![1565616948652](../../../../assets/image/1565616948652.png)

재설치를 한 후에 다시 build를 해주었더니 정상적으로 동작했습니다.  

![1565616991273](../../../../assets/image/1565616991273.png)

여기까지 하게 되면 폴더에 build라는 파일이 생기게 됩니다. 여기까지 왔다면 성공적으로 build를 진행한 것입니다.  

**.gitignore**에 build추가하기! 





### 2-3. graphql 파일 복사해서 넣기 

빌드된 곳에가서 **node server.js**를 실행시키게 되면 아래와 같은 에러를 발생시킵니다.  

![1565617169811](../../../../assets/image/1565617169811.png)

**async await**를 building process에 추가시켜야합니다.  



이것을 하기 위해 `.babelrc`에 몇가지 **plugin**을 추가해야합니다.  

[babel-plugin-transform-runtime](https://babeljs.io/docs/en/babel-plugin-transform-runtime)

#### 설치 

```bash
npm install --save-dev @babel/plugin-transform-runtime
```

```bash
npm install --save @babel/runtime
```

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- displayAd -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-4877378276818686"
     data-ad-slot="2489269721"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

#### 사용

![1565617371412](../../../../assets/image/1565617371412.png)

```json
// .babelrc
{
    "presets": ["@babel/preset-env"],
    "plugins": ["@babel/plugin-transform-runtime"]
}

```



두가지를 설치하고 **.babelrc**에 위 코드를 집어 넣고나서 아래 명령어를 실행시켜 줍니다. 

```bash
npm server.js
```

저는 **build**파일 경로까지 **cd**명령어를 들어간 후에 명령어를 사용한 것이기 때문에 build에 들어가지 않았다면  아래처럼 작성해주면 됩니다.  

```
npm build/server.js
```



그러면 아래와 같은 에러가 발생하게 됩니다.  

![1565617892843](../../../../assets/image/1565617892843.png)

graphql에 대한 정보가 build파일에 없기 때문에 발생하는 에러이기 때문에 정상적인 에러입니다. 여기까지 마쳤다면 다음으로는 build폴더 안에 graphql 파일을 복사해서 붙혀넣는 작업을 하도록 하겠습니다.  

